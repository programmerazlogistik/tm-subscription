---
title: "CropperResponsive"
description: "A responsive image cropper component designed for mobile and full-screen experiences with overlay interface."
---

import { CropperResponsivePreview } from "../../preview/CropperResponsive.preview";

## Usage

<CropperResponsivePreview />

```jsx
import { useState } from "react";

import { CropperResponsive } from "@muatmuat/ui/Cropper";

export default function Example() {
  const [isOpen, setIsOpen] = useState(false);
  const [imageSource, setImageSource] = useState("");
  const [croppedImage, setCroppedImage] = useState(null);

  const handleFileSelect = (event) => {
    const file = event.target.files[0];
    if (file) {
      setImageSource(URL.createObjectURL(file));
      setIsOpen(true);
    }
  };

  const handleCropResult = (result) => {
    setCroppedImage(result);
    setIsOpen(false);
  };

  const handleClose = (cancelled) => {
    setIsOpen(false);
  };

  return (
    <div className="p-6">
      <input
        type="file"
        accept="image/*"
        onChange={handleFileSelect}
        className="mb-4 block w-full text-sm text-gray-500 file:mr-4 file:rounded-full file:border-0 file:bg-blue-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-blue-700 hover:file:bg-blue-100"
      />

      <CropperResponsive
        isOpen={isOpen}
        setIsOpen={setIsOpen}
        imageSource={imageSource}
        result={handleCropResult}
        onClose={handleClose}
        isCircle={false}
        fileType="image/jpeg"
      />

      {croppedImage && (
        <div className="mt-4">
          <img
            src={croppedImage}
            alt="Cropped"
            className="h-32 w-32 rounded-full"
          />
        </div>
      )}
    </div>
  );
}
```

## API Reference

### Props

| Prop               | Type                             | Default        | Description                                            |
| ------------------ | -------------------------------- | -------------- | ------------------------------------------------------ |
| imageSource        | `string`                         | `""`           | The image source URL or data URL                       |
| result             | `(croppedImage: string) => void` | `undefined`    | Callback function triggered when cropping is completed |
| isOpen             | `boolean`                        | `required`     | Whether the cropper overlay is open                    |
| setIsOpen          | `(open: boolean) => void`        | `required`     | Function to control overlay open state                 |
| onClose            | `(cancelled: boolean) => void`   | `undefined`    | Callback function triggered when overlay is closed     |
| isCircle           | `boolean`                        | `false`        | Whether to crop as a circle                            |
| previewTitle       | `string`                         | `undefined`    | Title for preview screen                               |
| previewDescription | `string`                         | `undefined`    | Description for preview screen                         |
| uploadOptions      | `Array<UploadOption>`            | `undefined`    | Array of upload options for preview screen             |
| isShowPreview      | `boolean`                        | `false`        | Whether to show preview screen                         |
| setIsShowPreview   | `(show: boolean) => void`        | `undefined`    | Function to control preview state                      |
| fileType           | `string`                         | `"image/jpeg"` | File type for output image                             |

### Types

```typescript
interface UploadOption {
  title: string;
  src: string;
  onClick: () => void;
}
```

## Behavior

- Full-screen overlay interface optimized for mobile devices
- Zoom controls with intelligent zoom limits (2x max, 0.5x min of default)
- Circle cropping support with minimum crop box dimensions
- Integrated preview workflow with upload source selection
- Responsive design with proper aspect ratio handling
- State management for crop operations and preview workflow

**Variants**: Full-screen mobile overlay with header controls
**Sizes**: Full viewport coverage with aspect square constraint
**Key Guidelines**:

- Use for mobile-first image cropping workflows
- Ensure proper image source (URL or data URL) is provided
- Handle both crop completion and cancellation scenarios
- Configure zoom limits appropriately for use case

## Component Code

```tsx
import { useRef, useState } from "react";

import "cropperjs/dist/cropper.css";
//cropper
import Cropper, { ReactCropperElement } from "react-cropper";

// import CropperPreviewResponsive from "./CropperPreviewResponsive";
// TODO: This should be provided by the consuming application
// import { useHeader } from "./common/ResponsiveContext";

import { IconComponent } from "../IconComponent";
import style from "./CropperResponsive.module.scss";
import { ZoomEvent } from "./cropper-types";
import "./cropper_az.css";
import { CropperResponsiveProps } from "./types";

/**
 * A responsive image cropper component designed for mobile and full-screen experiences with overlay interface.
 * Features a full-screen overlay with zoom controls, circle cropping support, and preview functionality.
 */
export const CropperResponsive = ({
  imageSource = "",
  result,
  isOpen,
  setIsOpen,
  onClose,
  isCircle = false,
  previewTitle,
  // 24. THP 2 - MOD001 - MP - 015 - QC Plan - Web - MuatParts - Seller - Paket 039 A - Profil Seller - LB - 0066
  previewDescription,
  uploadOptions,
  isShowPreview,
  setIsShowPreview,
  fileType,
}: CropperResponsiveProps) => {
  const cropperRef = useRef<ReactCropperElement>(null);
  const [previewImage, setPreviewImage] = useState<string | null>(null);
  const defaultRatioRef = useRef<number | null>(null);
  // const { setAppBar } = useHeader();

  const getCropData = () => {
    if (cropperRef.current?.cropper) {
      setPreviewImage(
        cropperRef.current.cropper
          .getCroppedCanvas()
          .toDataURL(fileType ?? "image/png", 1.0)
      );
    }
    const cropper = cropperRef.current?.cropper;
    if (cropper) {
      cropper.reset();
    }
    setIsShowPreview?.(true);
  };

  const cancelCrop = () => {
    const cropper = cropperRef.current?.cropper;
    if (cropper) {
      cropper.reset();
    }
    // setAppBar({
    //   title: "Daftar Menjadi Toko",
    //   appBarType: "header_title",
    // });
    setIsOpen(false);
    onClose?.(true);
  };

  const handleConfirm = () => {
    //  setAppBar({
    //    title: "Daftar Menjadi Toko",
    //    appBarType: "header_title",
    //  });
    if (previewImage) {
      result?.(previewImage);
    }
    setIsShowPreview?.(false);
    setIsOpen(false);
  };

  const handleZoom = (event: ZoomEvent) => {
    const oldRatio = event.detail.oldRatio;
    const newDefaultRatio =
      defaultRatioRef.current !== null ? defaultRatioRef.current : oldRatio;
    const ratio = event.detail.ratio;
    const isZoomingIn = ratio > oldRatio;
    defaultRatioRef.current = newDefaultRatio;
    // Only prevent zooming in beyond 2x the default ratio
    if (isZoomingIn && ratio > newDefaultRatio * 2) {
      event.preventDefault();
    }
    // Allow zooming out until minimum ratio (usually around 0.1 or lower)
    // You can adjust this minimum value based on your needs
    if (!isZoomingIn && ratio < newDefaultRatio / 2) {
      event.preventDefault();
    }
  };

  if (!isOpen) {
    return null;
  }

  // if (isShowPreview) {
  //   return (
  //     // 24. THP 2 - MOD001 - MP - 015 - QC Plan - Web - MuatParts - Seller - Paket 039 A - Profil Seller - LB - 0066
  //     // syntax fix CropperPreviewResponsive -> CropperReviewResponsive by fariz (tidak bisa build - biar cepat. kalau salah bisa direvert)
  //     <CropperPreviewResponsive
  //       title={previewTitle}
  //       description={previewDescription}
  //       src={previewImage}
  //       setIsShowPreview={setIsShowPreview}
  //       onConfirm={handleConfirm}
  //       uploadOptions={uploadOptions}
  //       onCancelCrop={cancelCrop}
  //     />
  //   );
  // }

  return (
    <>
      <div className={"fixed left-0 top-0 z-50 h-screen w-full bg-[#20242F]"}>
        <div className="flex flex-row items-center justify-between p-4 pt-3">
          <div className="flex flex-row items-center gap-x-3">
            {/* <button
                            onClick={() => setIsOpen(false)}
                        > */}
            <IconComponent
              className={style.close_btn_icon}
              src="/icons/silang.svg"
              size="medium"
              onClick={cancelCrop}
            />
            {/* </button> */}
            <span className="text-base font-medium leading-[19.2px] text-white">
              Cropper
            </span>
          </div>
          <IconComponent
            // className={style.close_btn_icon}
            src="/icons/check_white.svg"
            size="medium"
            onClick={getCropData}
          />
        </div>
        <div className="flex min-h-[600px]">
          <div
            className={`m-auto aspect-square w-full ${isCircle ? "modal-cropper-circle" : ""} `}
          >
            {/* <div className="absolute bottom-[7.5px] right-[8px] z-50 flex h-[80px] flex-col rounded-[12px] border-[1px] border-[#E2E2E2] bg-[white]">
              <div
                className="flex h-1/2 cursor-pointer items-center justify-center text-2xl text-[black]"
                onClick={zoomIn}
              >
                +
              </div>
              <div
                className="flex h-1/2 cursor-pointer items-center justify-center p-[15px] text-2xl text-[black]"
                onClick={zoomOut}
              >
                <div className="w-[12px] border-[1.25px] border-[#1B1B1B]"></div>
              </div>
            </div> */}
            <Cropper
              ref={cropperRef}
              style={{ height: "100%", width: "100%" }}
              src={imageSource}
              aspectRatio={1}
              preview={".img-preview"}
              viewMode={0}
              background={true}
              responsive={true}
              autoCropArea={1}
              cropBoxResizable={true}
              minCropBoxHeight={isCircle ? 386 : 0}
              minCropBoxWidth={isCircle ? 300 : 0}
              zoom={handleZoom}
            />
          </div>
        </div>
      </div>
    </>
  );
};

CropperResponsive.displayName = "CropperResponsive";
```
